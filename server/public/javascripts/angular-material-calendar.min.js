angular.module("materialCalendar",["ngMaterial","ngSanitize"]),angular.module("materialCalendar").constant("materialCalendar.config",{version:"0.2.13",debug:document.domain.indexOf("localhost")>-1}),angular.module("materialCalendar").config(["materialCalendar.config","$logProvider","$compileProvider",function(e,t,a){e.debug&&(t.debugEnabled(!1),a.debugInfoEnabled(!1))}]),angular.module("materialCalendar").directive("compile",["$compile",function(e){return function(t,a,n){t.$watch(function(e){return e.$eval(n.compile)},function(n){a.html(n),e(a.contents())(t)})}}]),angular.module("materialCalendar").service("materialCalendar.Calendar",[function(){function e(e,t,a){var n=new Date;this.setWeekStartsOn=function(e){var t=parseInt(e||0,10);return!isNaN(t)&&t>=0&&6>=t?this.weekStartsOn=t:this.weekStartsOn=0,this.weekStartsOn},this.setStartDateOfMonth=function(e){var t=parseInt(e||1,10);return!isNaN(t)&&t>=1&&31>=t?this.startDateOfMonth=t:this.startDateOfMonth=1,this.startDateOfMonth},this.setNoOfDays=function(e){var t=parseInt(e||0,10);return!isNaN(t)&&t>0?this.noOfDays=t:this.noOfDays=0,this.noOfDays},this.options=angular.isObject(a)?a:{},this.year=n.getFullYear(),this.month=n.getMonth(),this.weeks=[],this.weekStartsOn=this.setWeekStartsOn(this.options.weekStartsOn),this.startDateOfMonth=this.setStartDateOfMonth(this.options.startDateOfMonth),this.noOfDays=this.setNoOfDays(this.options.noOfDays),this.next=function(){return this.start.getMonth()<11?void this.init(this.start.getFullYear(),this.start.getMonth()+1):void this.init(this.start.getFullYear()+1,0)},this.prev=function(){return this.month?void this.init(this.start.getFullYear(),this.start.getMonth()-1):void this.init(this.start.getFullYear()-1,11)},this.init=function(e,t){var a=new Date;this.year=angular.isDefined(e)?e:a.getFullYear(),this.month=angular.isDefined(t)?t:a.getMonth();var n=[31,28,31,30,31,30,31,31,30,31,30,31],i=n[this.month];1===this.month&&(this.year%4===0&&this.year%100!==0||this.year%400===0)&&(i=29),angular.isDefined(this.options.startDateOfMonth)?this.start=new Date(this.year,this.month,this.startDateOfMonth):this.start=new Date(this.year,this.month,1);var r=angular.copy(this.start);if(1===r.getDate())for(;r.getDay()!==this.weekStartsOn;)r.setDate(r.getDate()-1),i++;if(0!==this.noOfDays){for(;this.noOfDays%7!==0;)this.noOfDays++;i=this.noOfDays}else for(;i%7!==0;)i++;for(;i%7!==0;)i++;this.weeks=[];for(var o=0;i>o;++o)o%7===0&&this.weeks.push([]),this.weeks[this.weeks.length-1].push(angular.copy(r)),r.setDate(r.getDate()+1)},this.init(e,t)}return e}]),angular.module("materialCalendar").service("MaterialCalendarData",[function(){function e(){this.data={},this.available={},this.getDayKey=function(e){return[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-")},this.setDayContent=function(e,t){this.data[this.getDayKey(e)]=t||this.data[this.getDayKey(e)]||""},this.setDayAvailable=function(e,t){this.available[this.getDayKey(e)]=t||this.available[this.getDayKey(e)]||""}}return new e}]),angular.module("materialCalendar").directive("calendarMd",["$compile","$parse","$templateRequest","$q","materialCalendar.Calendar","MaterialCalendarData",function(e,t,a,n,i,r){var o="<md-content layout='column' layout-fill md-swipe-left='next()' md-swipe-right='prev()'><md-toolbar><div class='md-toolbar-tools' layout='row'><md-button class='md-icon-button' ng-click='prev()' aria-label='Previous month'><md-tooltip ng-if='::tooltips()'>Previous month</md-tooltip><md-icon>chevron_left</md-icon></md-button><div flex></div><h2 class='calendar-md-title'><span>{{ calendar.start | date:titleFormat:timezone }}</span></h2><div flex></div><md-button class='md-icon-button' ng-click='next()' aria-label='Next month'><md-tooltip ng-if='::tooltips()'>Next month</md-tooltip><md-icon>chevron_right</md-icon></md-button></div></md-toolbar><!-- agenda view --><md-content ng-if='weekLayout === columnWeekLayout' class='agenda'><div ng-repeat='week in calendar.weeks track by $index'><div ng-if='sameMonth(day)' ng-class='{&quot;disabled&quot; : isDisabled(day), active: active === day }' ng-click='handleDayClick(day)' ng-repeat='day in week' layout><md-tooltip ng-if='::tooltips()'>{{ day | date:dayTooltipFormat:timezone }}</md-tooltip><div>{{ day | date:dayFormat:timezone }}</div><div flex compile='dataService.data[dayKey(day)]'></div></div></div></md-content><!-- calendar view --><md-content ng-if='weekLayout !== columnWeekLayout' flex layout='column' class='calendar'><div layout='row' class='subheader'><div layout-padding class='subheader-day' flex ng-repeat='day in calendar.weeks[0]'><md-tooltip ng-if='::tooltips()'>{{ day | date:dayLabelTooltipFormat }}</md-tooltip>{{ day | date:dayLabelFormat }}</div></div><div ng-if='week.length' ng-repeat='week in calendar.weeks track by $index' flex layout='row'><div tabindex='{{ sameMonth(day) ? (day | date:dayFormat:timezone) : 0 }}' ng-repeat='day in week track by $index' ng-click='handleDayClick(day)' flex layout layout-padding ng-class='{&quot;disabled&quot; : isDisabled(day), &quot;active&quot;: isActive(day), &quot;md-whiteframe-12dp&quot;: hover || focus }' ng-focus='focus = true;' ng-blur='focus = false;' ng-mouseleave='hover = false' ng-mouseenter='hover = true'><md-tooltip ng-if='::tooltips()'>{{ day | date:dayTooltipFormat }}</md-tooltip><div>{{ day | date:dayFormat }}</div><div flex compile='dataService.data[dayKey(day)]' id='{{ day | date:dayIdFormat }}'></div></div></div></md-content></md-content>",s=function(){var e="calendarMdCss";if(!document.getElementById(e)){var t=document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.id=e,a.innerHTML="calendar-md md-content>md-content.agenda>*>* :not(:first-child),calendar-md md-content>md-content.calendar>:not(:first-child)>* :last-child{overflow:hidden;text-overflow:ellipsis}calendar-md{display:block;max-height:100%}calendar-md .md-toolbar-tools h2{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md .md-toolbar-tools .moveNext{transform:translate3d(0,0,0) rotate(180deg)}calendar-md md-content>md-content{border:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>*{border-bottom:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.agenda>*>* :first-child{padding:12px;width:200px;text-align:right;color:rgba(0,0,0,.75);font-weight:100;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md md-content>md-content>*>*{min-width:48px}calendar-md md-content>md-content.calendar>:first-child{background:rgba(0,0,0,.02);border-bottom:1px solid rgba(0,0,0,.12);margin-right:0;min-height:36px}calendar-md md-content>md-content.calendar>:not(:first-child)>*{border-bottom:1px solid rgba(0,0,0,.12);border-right:1px solid rgba(0,0,0,.12);cursor:pointer}calendar-md md-content>md-content.calendar>:not(:first-child)>:hover{background:rgba(0,0,0,.04)}calendar-md md-content>md-content.calendar>:not(:first-child)>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.calendar>:not(:first-child)>.active{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);background:rgba(0,0,0,.02)}calendar-md md-content>md-content.calendar>:not(:first-child)>* :first-child{padding:0}",t.insertBefore(a,t.firstChild)}};return{restrict:"E",scope:{ngModel:"=?",template:"&",templateUrl:"=?",onDayClick:"=?",onPrevMonth:"=?",onNextMonth:"=?",calendarDirection:"=?",dayContent:"&?",dayAvailable:"&?",timezone:"=?",titleFormat:"=?",dayFormat:"=?",dayLabelFormat:"=?",dayLabelTooltipFormat:"=?",dayTooltipFormat:"=?",weekStartsOn:"=?",tooltips:"&?",startDateOfMonth:"=?",noOfDays:"=?",clearDataCacheOnLoad:"=?",disableFutureSelection:"=?",disableSelection:"=?"},link:function(l,d,c){s();var u=new Date,h=parseInt(c.startMonth||u.getMonth()),m=parseInt(c.startYear||u.getFullYear());l.columnWeekLayout="column",l.weekLayout="row",l.timezone=l.timezone||null,l.noCache=c.clearDataCacheOnLoad||!1,c.ngModel?(l.active=l.$parent.$eval(c.ngModel),c.ngModel&&l.$watch("$parent."+c.ngModel,function(e){l.active=e})):l.active=null,l.titleFormat=l.titleFormat||"LLLL yyyy",l.dayLabelFormat=l.dayLabelFormat||"EEE",l.dayLabelTooltipFormat=l.dayLabelTooltipFormat||"EEEE",l.dayFormat=l.dayFormat||"d",l.dayTooltipFormat=l.dayTooltipFormat||"fullDate",l.dayIdFormat="dd-MM-yy",l.disableFutureSelection=l.disableFutureSelection||!1,l.disableSelection=l.disableSelection||!1,l.sameMonth=function(e){var t=angular.copy(e);return t.getFullYear()===l.calendar.year&&t.getMonth()===l.calendar.month},l.isDisabled=function(e,t,a){if(0!=a&&angular.isDefined(a)){var n=new Date(l.calendar.year,l.calendar.month,t),i=angular.copy(n);if(i.setDate(n.getDate()+parseInt(a)),e.getDate()<=n&&e.getDate()>=i)return!0}return l.disableSelection?!0:l.disableFutureSelection&&e>new Date?!0:l.dataService.available[l.dayKey(e)]?!l.sameMonth(e):!0},l.calendarDirection=l.calendarDirection||"horizontal",l.$watch("calendarDirection",function(e){l.weekLayout="horizontal"===e?"row":"column"}),l.$watch("weekLayout",function(){m=l.calendar.year,h=l.calendar.month,k()});var f=function(e,t){(e||angular.noop)(t)},p=function(e,t){var a=-1;return angular.forEach(e,function(e,n){0>a&&angular.equals(t,e)&&(a=n)}),a};l.isActive=function(e){var t,a=angular.copy(l.active);return angular.isArray(a)?t=p(a,e)>-1:a&&angular.equals(a.getYear(),e.getYear())&&angular.equals(a.getMonth(),e.getMonth())&&angular.equals(a.getDate(),e.getDate())&&(t=!0),t},l.prev=function(){l.calendar.prev();var e={year:l.calendar.year,month:l.calendar.month+1};w(),x(),f(l.onPrevMonth,e)},l.next=function(){l.calendar.next();var e={year:l.calendar.year,month:l.calendar.month+1};w(),x(),f(l.onNextMonth,e)},l.handleDayClick=function(e){if(!(l.disableFutureSelection&&e>new Date||l.disableSelection)){var a=angular.copy(l.active);if(angular.isArray(a)){var n=p(a,e);n>-1?a.splice(n,1):a.push(e)}else a=angular.equals(a,e)?null:e;l.active=a,c.ngModel&&t(c.ngModel).assign(l.$parent,angular.copy(l.active)),f(l.onDayClick,angular.copy(e))}};var g=function(t){d.html(t),e(d.contents())(l)},y=function(){return l.calendar=new i(m,h,{weekStartsOn:l.weekStartsOn||0,startDateOfMonth:l.startDateOfMonth||1,noOfDays:l.noOfDays||0}),l.templateUrl?a(l.templateUrl):n.resolve(l.template()||o)};l.dataService=r;var v=function(e){return l.dataService.getDayKey(e)};l.dayKey=v;var b=function(e){l.noCache?l.dataService.setDayContent(e,""):l.dataService.setDayContent(e,l.dataService.data[v(e)]||"");var t=(l.dayContent||angular.noop)(),a=(t||angular.noop)(e);angular.isObject(a)&&"function"==typeof a.success?a.success(function(t){l.dataService.setDayContent(e,t)}):angular.isObject(a)&&"function"==typeof a.then?a.then(function(t){l.dataService.setDayContent(e,t)}):l.dataService.setDayContent(e,a)},D=function(e){l.noCache?l.dataService.setDayAvailable(e,""):l.dataService.setDayAvailable(e,l.dataService.available[v(e)]||"");var t=(l.dayAvailable||angular.noop)(),a=(t||angular.noop)(e);angular.isObject(a)&&"function"==typeof a.success?a.success(function(t){l.dataService.setDayAvailable(e,t)}):angular.isObject(a)&&"function"==typeof a.then?a.then(function(t){l.dataService.setDayAvailable(e,t)}):l.dataService.setDayAvailable(e,a)},w=function(){angular.forEach(l.calendar.weeks,function(e){angular.forEach(e,b)})},x=function(){angular.forEach(l.calendar.weeks,function(e){angular.forEach(e,D)})};window.data=l.data;var k=function(){y().then(function(e){g(e),w(),x()})};l.$watchGroup(["weekStartsOn","startDateOfMonth","noOfDays"],y),k(),l._$$init=y,l._$$setTemplate=g,l._$$bootstrap=k}}}]);
