var app1=angular.module("app1",["ngRoute","ngResource","ngMaterial","ngMessages","ngCookies","materialCalendar","infinite-scroll","materialCarousel","materialCalendar"]).config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("blue-grey").accentPalette("amber"),e.theme("user1").primaryPalette("purple").accentPalette("green"),e.theme("user2").primaryPalette("pink").accentPalette("orange"),e.theme("user3").primaryPalette("blue").accentPalette("light-blue"),e.alwaysWatchTheme(!0),e.generateThemesOnDemand(!1)}]).factory("Applications",["$resource",function(e){return e("/client/application/:id",null,{update:{method:"PUT"}})}]).factory("User",["$resource",function(e){return e("/client/user/:id",null,{update:{method:"PUT"}})}]).factory("Password",["$resource",function(e){return e("/authentication/password",null,{update:{method:"PUT"}})}]).factory("Company",["$resource",function(e){return e("/client/company/:id",null,{update:{method:"PUT"}})}]).factory("Login",["$resource",function(e){return e("/authentication/login",null,{update:{method:"PUT"}})}]).factory("UserStatus",["$resource",function(e){return e("/authentication/status",null,{update:{method:"PUT"}})}]).factory("Logout",["$resource",function(e){return e("/authentication/logout",null,{update:{method:"PUT"}})}]).factory("Register",["$resource",function(e){return e("/authentication/register",null,{update:{method:"PUT"}})}]).factory("Notify",["$resource",function(e){return e("/client/notify/:user_id",null,{update:{method:"PUT"}})}]).factory("Forms",["$resource",function(e){return e("/client/form/:id",null,{update:{method:"PUT"}})}]).factory("Value",["$resource",function(e){return e("/client/value/:id",null,{update:{method:"PUT"}})}]).factory("Share",["$resource",function(e){return e("/client/share",null,{update:{method:"PUT"}})}]).factory("Calendar",["$resource",function(e){return e("/client/calendar",null,{update:{method:"PUT"}})}]).factory("Event",["$resource",function(e){return e("/client/event/:id",null,{update:{method:"PUT"}})}]).factory("Files",["$resource",function(e){return e("/file/:id",null,{update:{method:"PUT"}})}]).factory("FileUrl",["$resource",function(e){return e("/file/url/:id",null,{update:{method:"PUT"}})}]).factory("Datas",["$resource",function(e){return e("/data/:datamodel_id/:entry_id",{datamodel_id:"@datamodel_id",entry_id:"@entry_id"},{update:{method:"PUT"}})}]).factory("SessionService",["AppTranslationService","$location","$resource","$window","$cookies","Login","Logout","UserStatus","Applications","User",function(e,t,a,r,o,n,i,l,s,c){var p={userData:{properties:{theme:"default",language:"en"},cookie:""},applicationName:"App1",appData:{}},u=function(e){if(!e)return"xxxxx";var t=e[p.userData.properties.language];return t?t:e.en},d=function(e,t){if(!e)return"xxxxx";var a=e[t];return a?a:e.en},f=function(e){if(e.applications)for(var t=0;t<e.applications.length;t++)e.applications[t].translated_name=d(e.applications[t].name,e.userData.properties.language),e.applications[t].translated_description=d(e.applications[t].description,e.userData.properties.language);p=e},m=function(){return p},h=function(a,r){p={},p.token=a.token,p.userData=a.user,p.userData.title=(a.user.firstname?a.user.firstname:"")+" "+(a.user.lastname?a.user.lastname:"")+(a.user.company.name?" @ "+a.user.company.name:""),p.userData.name=(a.user.firstname?a.user.firstname:"")+" "+(a.user.lastname?a.user.lastname:""),p.appData=e.translate(p.userData.properties.language),p.userData.cookie=o.get("app1_token"),s.query().$promise.then(function(e){p.applications=e;var a=p.applications,o=!1;p.userData.properties.app_score||(p.userData.properties.app_score={},o=!0);for(var n=0;n<a.length;n++)a[n].translated_name=u(a[n].name),a[n].translated_description=u(a[n].description),p.userData.properties.app_score[a[n]._id]||(p.userData.properties.app_score[a[n]._id]=75,o=!0);a.sort(function(e,t){return p.userData.properties.app_score[t._id]-p.userData.properties.app_score[e._id]}),o&&c.update({id:p.userData._id},{properties:p.userData.properties}),r?(p.applicationName=p.appData.home,v("/applications")):"/"==t.path()&&v("/applications")})["catch"](function(e){})},g=function(){l.get().$promise.then(function(e){h(e,!1)})["catch"](function(t){p.appData=e.translate(p.userData.properties.language),p.userData.cookie="",v("/")})},_=function(e){for(var t=0;t<p.applications.length;t++)p.userData.properties.app_score[p.applications[t]._id]*=.99;p.userData.properties.app_score[e]=Math.min(100,1.02*p.userData.properties.app_score[e]),p.applications.sort(function(e,t){return p.userData.properties.app_score[t._id]-p.userData.properties.app_score[e._id]}),c.update({id:p.userData._id},{properties:p.userData.properties})},$=function(t,a){var r=new n({user:t,password:a});r.$save(function(e){h(e,!0)})["catch"](function(t){p.appData=e.translate(p.userData.properties.language),v("/")})},y=function(){i.get(),p={userData:{properties:{theme:"default",language:"en"},cookie:""},applicationName:"App1"},p.appData=e.translate(p.userData.properties.language),v("/")},v=function(e,a){var n=o.get("app1_token");return n!=p.userData.cookie?(p.userData.cookie=n,t.url("/applications"),void(a||r.scrollTo(0,0))):(t.url(e),void(a||r.scrollTo(0,0)))};return{setSessionData:f,getSessionData:m,translate:u,init:g,openApp:_,login:$,logout:y,location:v}}]).factory("MapService",function(){var e=[],t=function(t){e[t]=new google.maps.Map(document.getElementById(t),{zoom:2,scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!1,mapTypeId:google.maps.MapTypeId.ROADMAP})},a=function(t,a){var r=new google.maps.Geocoder;r.geocode({address:a},function(a,r){"OK"===r&&(e[t].setCenter(a[0].geometry.location),e[t].setZoom(14))})};return{geocodeAddress:a,initMap:t}}).controller("AppCtrl",["$scope","$timeout","$mdSidenav","SessionService",function(e,t,a,r){function o(a,r,o){var n;return function(){var o=e,i=Array.prototype.slice.call(arguments);t.cancel(n),n=t(function(){n=void 0,a.apply(o,i)},r||10)}}function n(e){return o(function(){a(e).toggle()},200)}r.init(),e.sessionData=r.getSessionData(),e.$watch(function(){return r.getSessionData()},function(t,a){t!=a&&(e.sessionData=t)}),e.closeLeft=function(){a("left").close()},e.closeRight=function(){a("right").close()},e.logout=function(){a("right").close(),r.logout()},e.open=function(t){r.openApp(t._id),"url"==t.type?r.location("/url/"+t._id+"?iframe_url="+t.url):"file"==t.type?r.location("/file/"+t._id+"?iframe_file="+t.file):r.location("/workflows/"+t._id),e.closeLeft()},e.toggleLeft=n("left"),e.toggleRight=n("right")}]).config(["$routeProvider",function(e){e.when("/form/:id/:entry_id",{templateUrl:"core/forms.html",controller:"FormDetailsCtrl"}).when("/workflows/:application_id",{templateUrl:"core/workflows.html",controller:"WorkflowsCtrl"}).when("/url/:application_id",{templateUrl:"core/url.html",controller:"UrlCtrl"}).when("/file/:application_id",{templateUrl:"core/file.html",controller:"FileCtrl"}).when("/welcome",{templateUrl:"core/welcome.html",controller:"WelcomeCtrl"}).when("/register",{templateUrl:"core/register.html",controller:"RegisterCtrl"}).when("/login",{templateUrl:"core/login.html",controller:"LoginCtrl"}).when("/user",{templateUrl:"core/user.html",controller:"UserCtrl"}).when("/company",{templateUrl:"core/company.html",controller:"CompanyCtrl"}).when("/applications",{templateUrl:"core/applications.html",controller:"ApplicationsCtrl"}).when("/designer",{templateUrl:"designer/designer.html",controller:"DesignerCtrl"}).when("/application_edit/:id",{templateUrl:"designer/application.html",controller:"ApplicationEditCtrl"}).when("/application_share/:id",{templateUrl:"designer/share.html",controller:"ApplicationShareCtrl"}).when("/workflow_edit/:id",{templateUrl:"designer/workflow.html",controller:"WorkflowEditCtrl"}).when("/form_edit/:id",{templateUrl:"designer/form.html",controller:"FormEditCtrl"}).when("/form_display_edit/:id",{templateUrl:"designer/display.html",controller:"FormDisplayEditCtrl"}).when("/form_action_edit/:id",{templateUrl:"designer/action.html",controller:"FormActionEditCtrl"}).when("/form_value_edit/:id",{templateUrl:"designer/value.html",controller:"FormValueEditCtrl"}).when("/datamodel",{templateUrl:"datamodel/datamodel.html",controller:"DatamodelCtrl"}).when("/datamodel/:id",{templateUrl:"datamodel/datamodeledit.html",controller:"DatamodelEditCtrl"}).otherwise({redirectTo:"/",templateUrl:"core/welcome.html",controller:"WelcomeCtrl"})}]);
