app1.controller("FormEditCtrl",["$scope","$resource","$location","$routeParams","$mdDialog","SessionService","DesignForm","DesignDataModel",function(e,t,a,o,n,i,s,r){e.sessionData=i.getSessionData(),e.$watch(function(){return i.getSessionData()},function(t,a){t!=a&&(e.sessionData=t)}),s.get({id:o.id},function(t,a){e.form=t,e.sessionData.applicationName=e.sessionData.appData.app_designer,i.setSessionData(e.sessionData)}),r.query(function(t){for(var a=0;a<t.length;a++)t[a].translated_name=i.translate(t[a].name);e.datamodels=t}),e.editText=function(e,t,a){n.show({templateUrl:"designer/text.html",controller:"TextCtrl",locals:{text:e[t],multipleLines:a},parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(a){e[t]=a})},e.editAction=function(e){i.url("/form_edit/"+e)},e.newAction=function(){n.show(n.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_workflow).textContent(e.sessionData.appData.new_workflow_name).initialValue("My Form").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(t){var a=new DesignWorkflow({name:{en:t}});a.$save(function(){a.translated_name=a.name.en,e.application.workflows.push(a)})})},e.newSection=function(){n.show(n.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_field).textContent(e.sessionData.appData.new_field_name).initialValue("New Field").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(t){e.form.display||(e.form.display=[]),e.form.display.push({blocks:[{fields:[{name:t}]}]})})},e.newBlock=function(t){n.show(n.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_field).textContent(e.sessionData.appData.new_field_name).initialValue("New Field").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(a){e.form.display||(e.form.display=[]),t.push({fields:[{name:a}]})})},e.newField=function(t){n.show(n.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_field).textContent(e.sessionData.appData.new_field_name).initialValue("New Field").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(a){e.form.display||(e.form.display=[]),t.push({name:a})})},e.save=function(){s.update({id:e.form._id},e.form).$promise.then(function(e){i.init(),i.url("/workflow_edit/"+o.workflow_id+"?application_id="+o.application_id)})["catch"](function(t){e.application=t.application,updateErrorAlert()})},e.onDragEnter=function(e){element.classList.add("dash_line")}}]);
