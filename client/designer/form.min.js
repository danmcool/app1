app1.controller("FormEditCtrl",["$scope","$resource","$location","$routeParams","$mdDialog","SessionService","DesignForm","DataModels",function(e,a,t,n,o,i,s,r){e.sessionData=i.getSessionData(),e.$watch(function(){return i.getSessionData()},function(a,t){a!=t&&(e.sessionData=a)}),s.get({id:n.id},function(a,t){e.form=a,e.sessionData.applicationName=e.sessionData.appData.app_designer,i.setSessionData(e.sessionData)}),e.editText=function(e,a,t){o.show({templateUrl:"designer/text.html",controller:"TextCtrl",locals:{text:e[a],multipleLines:t},parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(t){e[a]=t})},e.editAction=function(e){t.url("/form_edit/"+e)},e.newAction=function(){o.show(o.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_workflow).textContent(e.sessionData.appData.new_workflow_name).initialValue("My Form").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(a){var t=new DesignWorkflow({name:{en:a}});t.$save(function(){t.translated_name=t.name.en,e.application.workflows.push(t)})})},e.newSection=function(){o.show(o.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_field).textContent(e.sessionData.appData.new_field_name).initialValue("New Field").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(a){e.form.display||(e.form.display=[]),e.form.display.push({blocks:[{fields:[{name:a}]}]})})},e.newBlock=function(a){o.show(o.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_field).textContent(e.sessionData.appData.new_field_name).initialValue("New Field").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(t){e.form.display||(e.form.display=[]),a.push({fields:[{name:t}]})})},e.newField=function(a){o.show(o.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_field).textContent(e.sessionData.appData.new_field_name).initialValue("New Field").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(t){e.form.display||(e.form.display=[]),a.push({name:t})})},e.save=function(){s.update({id:e.form._id},e.form).$promise.then(function(e){i.init(),t.url("/workflow_edit/"+n.workflow_id+"?application_id="+n.application_id)})["catch"](function(a){e.application=a.application,updateErrorAlert()})},e.onDragEnter=function(e){element.classList.add("dash_line")}}]);
