app1.controller("ApplicationSecurityCtrl",["$scope","SessionService","DesignApplication","DesignWorkflow","DesignForm","Files","$location","$routeParams","$mdDialog",function(e,a,t,o,s,i,r,n,l){e.sessionData=a.getSessionData(),e.$watch(function(){return a.getSessionData()},function(a,t){a!=t&&(e.sessionData=a)}),t.get({id:n.id},function(t,o){if(t.profiles)for(var s=0;s<t.profiles.length;s++)t.profiles[s].translated_name=a.translate(t.profiles[s].name),t.profiles[s].translated_description=a.translate(t.profiles[s].description);e.application=t,e.sessionData.applicationName=e.sessionData.appData.app_designer,a.setSessionData(e.sessionData)}),e.editText=function(e,a,t){e[a]||(e[a]={}),l.show({templateUrl:"designer/text.html",controller:"TextCtrl",locals:{text:e[a],multipleLines:t},parent:angular.element(document.body),clickOutsideToClose:!0},function(t){e[a]=t})},e.editProfile=function(o){t.update({id:e.application._id},e.application,function(t){a.init(),a.location("/profile_edit/"+o+"?application_id="+e.application._id)},function(a){e.application=a.application,updateErrorAlert()})},e.newProfile=function(){var a={};a[e.sessionData.userData.properties.language]="";var o=new DesignProfile({name:a});o.$save(function(){o.translated_name=o.name.en,e.application.profiles.push(o),t.update({id:e.application._id},e.application,function(e){},function(a){e.application=a.application,updateErrorAlert()})})},e.deleteForm=function(a){var t=e.workflow.forms[a]._id;e.workflow.forms.splice(a,1),o.update({id:e.workflow._id},e.workflow,function(e){s.remove({id:t},function(e){},function(e){})})},e.save=function(){t.update({id:e.application._id},e.application,function(e){a.init(),a.location("/application_edit/"+n.application_id)},function(a){e.application=a.application,updateErrorAlert()})}}]);
