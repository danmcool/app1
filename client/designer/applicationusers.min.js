app1.controller("ApplicationUsersCtrl",["$scope","SessionService","DesignApplication","DesignWorkflow","DesignForm","User","$location","$routeParams","$mdDialog",function(e,t,o,a,s,i,r,n,l){e.sessionData=t.getSessionData(),e.$watch(function(){return t.getSessionData()},function(t,o){t!=o&&(e.sessionData=t)}),e.search_text="",e.skip=0,e.limit=10,e.users=[],e.stopScroll=!1,e.tempStopScroll=!1,e.selected_profile=null,e.getNextUsers=function(){if(!e.stopScroll&&!e.tempStopScroll&&e.selected_profile){var t=e.limit,o=e.skip;e.skip+=e.limit,e.tempStopScroll=!0,i.query({search_text:e.search_text,skip:o,limit:t,sort_by:{lastname:"ascending",firstname:"ascending"}}).$promise.then(function(t){t.length<e.limit&&(e.stopScroll=!0);for(var o=0;o<t.length;o++)e.users.push(t[o]);e.tempStopScroll=!1})}},e.search=function(t){t||(t=""),e.search_text=t,e.skip=0,e.limit=10,e.stopScroll=!1,e.tempStopScroll=!1,e.users=[],e.getNextUsers()},o.get({id:n.id},function(o,a){if(o.profiles){for(var s=0;s<o.profiles.length;s++)o.profiles[s].translated_name=t.translate(o.profiles[s].name),o.profiles[s].translated_description=t.translate(o.profiles[s].description);o.profiles.length>0&&(e.selected_profile=o.profiles[0]._id)}e.application=o,e.sessionData.applicationName=e.sessionData.appData.app_designer,t.setSessionData(e.sessionData),e.getNextUsers()}),e.removeUserProfile=function(t){t.remote_profiles||(t.remote_profiles=[]);for(var o=0;o<t.remote_profiles.length;o++)if(t.remote_profiles[o]==e.selected_profile){t.remote_profiles.splice(o,1);break}i.update({id:t._id},{remote_profiles:t.remote_profiles})},e.addUserProfile=function(t){t.remote_profiles||(t.remote_profiles=[]),t.remote_profiles.push(e.selected_profile),i.update({id:t._id},{remote_profiles:t.remote_profiles})},e.save=function(){t.init(),t.location("/designer")},e.changeProfile=function(){e.skip=0,e.limit=10,e.users=[],e.stopScroll=!1,e.tempStopScroll=!1,e.getNextUsers()}}]);
