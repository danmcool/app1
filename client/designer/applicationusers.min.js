app1.controller("ApplicationUsersCtrl",["$scope","SessionService","DesignApplication","DesignWorkflow","DesignForm","User","$location","$routeParams","$mdDialog",function(e,a,t,o,s,i,r,n,l){e.sessionData=a.getSessionData(),e.$watch(function(){return a.getSessionData()},function(a,t){a!=t&&(e.sessionData=a)}),e.search_text="",e.skip=0,e.limit=10,e.users=[],e.stopScroll=!1,e.tempStopScroll=!1,e.selected_profile=null,e.getNextUsers=function(){if(!e.stopScroll&&!e.tempStopScroll&&e.selected_profile){var a=e.limit,t=e.skip;e.skip+=e.limit,e.tempStopScroll=!0,i.query({search_text:e.search_text,skip:t,limit:a,sort_by:{lastname:"ascending",firstname:"ascending"}},function(a){a.length<e.limit&&(e.stopScroll=!0);for(var t=0;t<a.length;t++)e.users.push(a[t]);e.tempStopScroll=!1})}},e.search=function(a){a||(a=""),e.search_text=a,e.skip=0,e.limit=10,e.stopScroll=!1,e.tempStopScroll=!1,e.users=[],e.getNextUsers()},t.get({id:n.id},function(t,o){if(t.profiles){for(var s=0;s<t.profiles.length;s++)t.profiles[s].translated_name=a.translate(t.profiles[s].name),t.profiles[s].translated_description=a.translate(t.profiles[s].description);t.profiles.length>0&&(e.selected_profile=t.profiles[0]._id)}e.application=t,e.sessionData.applicationName=e.sessionData.appData.app_designer,a.setSessionData(e.sessionData),e.getNextUsers()}),e.removeUserProfile=function(a){a.remote_profiles||(a.remote_profiles=[]);for(var t=0;t<a.remote_profiles.length;t++)if(a.remote_profiles[t]==e.selected_profile){a.remote_profiles.splice(t,1);break}i.update({id:a._id},{remote_profiles:a.remote_profiles})},e.addUserProfile=function(a){a.remote_profiles||(a.remote_profiles=[]),a.remote_profiles.push(e.selected_profile),i.update({id:a._id},{remote_profiles:a.remote_profiles})},e.save=function(){a.init(),a.location("/designer")},e.changeProfile=function(){e.skip=0,e.limit=10,e.users=[],e.stopScroll=!1,e.tempStopScroll=!1,e.getNextUsers()}}]);
