app1.controller("FormDisplayEditCtrl",["$scope","$routeParams","$mdDialog","SessionService","DesignForm","DesignDataModel","DesignWorkflow",function(e,a,t,o,n,s,r){e.sessionData=o.getSessionData(),e.$watch(function(){return o.getSessionData()},function(a,t){a!=t&&(e.sessionData=a)}),e.section_index=a.section,e.block_index=a.block,e.field_index=a.field,e.display_type={list:{en:"List",fr:"Liste"},item:{en:"Detail List",fr:"Liste des détails"},shorttext:{en:"Text",fr:"Texte"},number:{en:"Number",fr:"Nombre"},currency:{en:"Amount",fr:"Montant"},editor:{en:"Text Editor",fr:"Editeur texte"},feed:{en:"Discussion Feed",fr:"Fil de discussion"},file:{en:"File",fr:"Fichier"},selection:{en:"Selection",fr:"Selection"},check:{en:"Check",fr:"Contrôle"},calendar:{en:"Calendar",fr:"Calendrier"},calculation:{en:"Formula",fr:"Formule"},email:{en:"Email",fr:"Courriel"},address:{en:"Address",fr:"Adresse"}},e.title_display_type={text:{en:"Text",fr:"Texte"},value:{en:"Value",fr:"Valeur"},currency:{en:"Amount",fr:"Montant"}};var l=Object.keys(e.display_type);for(e.display_types=[],i=0;i<l.length;i++)e.display_types.push({translated_name:o.translate(e.display_type[l[i]]),type:l[i]});var d=Object.keys(e.title_display_type);for(e.title_display_types=[],i=0;i<d.length;i++)e.title_display_types.push({translated_name:o.translate(e.title_display_type[d[i]]),type:d[i]});e.list_action_type={modify:{en:"Modify",fr:"Modifier"},"delete":{en:"Delete",fr:"Supprimer"},link:{en:"Link",fr:"Lien"}},e.item_action_type={modify_item:{en:"Modify",fr:"Modifier"},delete_item:{en:"Delete",fr:"Supprimer"},link_item:{en:"Link",fr:"Lien"},move_item:{en:"Move Item",fr:"Deplacer element"}};var c=Object.keys(e.list_action_type);for(e.list_action_types=[],i=0;i<c.length;i++)e.list_action_types.push({translated_name:o.translate(e.list_action_type[c[i]]),type:c[i]});var f=Object.keys(e.item_action_type);for(e.item_action_types=[],i=0;i<f.length;i++)e.item_action_types.push({translated_name:o.translate(e.item_action_type[f[i]]),type:f[i]});n.get({id:a.id},function(a,t){if(e.form=a,e.form.translated_name=o.translate(e.form.name),e.field=e.form.display[e.section_index].blocks[e.block_index].fields[e.field_index],e.datamodel_keys=[],e.form.datamodel)for(var i=Object.keys(e.form.datamodel.translation),n=0;n<i.length;n++)e.datamodel_keys.push({translated_name:o.translate(e.form.datamodel.translation[i[n]]),id:i[n]});if(e.form.actions)for(var n=0;n<e.form.actions.length;n++)e.form.actions[n].translated_name=o.translate(e.form.actions[n].name);if(e.form.values)for(var n=0;n<e.form.values.length;n++)e.form.values[n].translated_name=o.translate(e.form.values[n].name);e.sessionData.applicationName=e.sessionData.appData.app_designer,o.setSessionData(e.sessionData)}),r.get({id:a.workflow_id},function(a,t){for(var i=0;i<a.forms.length;i++)a.forms[i].translated_name=o.translate(a.forms[i].name),a.forms[i].translated_description=o.translate(a.forms[i].description);e.forms=a.forms;var n={_id:"home",name:{en:"Application Home",fr:"Accueil de l`application"}};n.translated_name=o.translate(n.name),e.forms.push(n)}),e.editText=function(e,a,o){e[a]||(e[a]={}),t.show({templateUrl:"designer/text.html",controller:"TextCtrl",locals:{text:e[a],multipleLines:o},parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(t){e[a]=t})},e.save=function(){n.update({id:e.form._id},e.form).$promise.then(function(t){o.init(),o.location("/form_edit/"+e.form._id+"?application_id="+a.application_id+"&workflow_id="+a.workflow_id)})["catch"](function(e){p()})};var p=function(){t.show(t.alert().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_document_version).textContent(e.sessionData.appData.already_modified_document).ok(e.sessionData.appData.ok))}}]);
