app1.controller("ApplicationEditCtrl",["$scope","SessionService","DesignApplication","DesignWorkflow","$location","$routeParams","$mdDialog",function(e,a,s,o,t,n,i){e.sessionData=a.getSessionData(),e.$watch(function(){return a.getSessionData()},function(a,s){a!=s&&(e.sessionData=a)}),s.get({id:n.id},function(s,o){if(s.workflows)for(var t=0;t<s.workflows.length;t++)s.workflows[t].translated_name=a.translate(s.workflows[t].name),s.workflows[t].translated_description=a.translate(s.workflows[t].description);e.application=s,e.sessionData.applicationName=e.sessionData.appData.app_designer,a.setSessionData(e.sessionData)}),e.editText=function(e,a,s){i.show({templateUrl:"designer/text.html",controller:"TextCtrl",locals:{text:e[a],multipleLines:s},parent:angular.element(document.body),clickOutsideToClose:!0}).then(function(s){e[a]=s})},e.editWorkflow=function(o){s.update({id:e.application._id},e.application).$promise.then(function(s){a.init(),t.url("/workflow_edit/"+o+"?application_id="+e.application._id)})["catch"](function(a){e.application=a.application,updateErrorAlert()})},e.newWorkflow=function(){i.show(i.prompt().parent(angular.element(document.body)).clickOutsideToClose(!0).title(e.sessionData.appData.new_workflow).textContent(e.sessionData.appData.new_workflow_name).initialValue("My Workflow").ok(e.sessionData.appData.ok).cancel(e.sessionData.appData.cancel)).then(function(a){var s=new o({name:{en:a}});s.$save(function(){s.translated_name=s.name.en,e.application.workflows.push(s)})})},e.save=function(){s.update({id:e.application._id},e.application).$promise.then(function(e){a.init(),t.url("/designer")})["catch"](function(a){e.application=a.application,updateErrorAlert()})}}]);
