app1.controller("UserCtrl",["$scope","$location","$window","SessionService","AppTranslationService","User","Password",function(e,r,t,n,a,o,i){e.password={current:"","new":"",repeat:""},e.sessionData=n.getSessionData(),e.sessionData.applicationName="App1",n.setSessionData(e.sessionData),e.$watch(function(){return n.getSessionData()},function(r,t){r!=t&&(e.sessionData=r,e.sessionData.applicationName="App1",n.setSessionData(e.sessionData))}),e.saveUserData=function(){if(e.sessionData.userData.properties.uiLanguage&&"auto"==e.sessionData.userData.properties.uiLanguage){var r=t.navigator.userLanguage||t.navigator.language;r?e.sessionData.userData.properties.correctedLanguage=r.startsWith("en")?"en":r.startsWith("fr")?"fr":"en":e.sessionData.userData.properties.correctedLanguage="en"}else e.sessionData.userData.properties.correctedLanguage=e.sessionData.userData.properties.uiLanguage;e.sessionData.appData=a.translate(e.sessionData.userData.properties.correctedLanguage),n.setSessionData(e.sessionData),o.update({id:e.sessionData.userData._id},{properties:e.sessionData.userData.properties}),n.location("/applications")},e.changeUserPassword=function(){i.update({old:e.password.old,"new":e.password["new"]}),n.location("/applications")},e.validatePassword=function(){e.password["new"]==e.password.repeat?e.userPasswordForm.password_repeat.$setValidity("userPasswordForm.password_repeat.$error.match",!0):e.userPasswordForm.password_repeat.$setValidity("userPasswordForm.password_repeat.$error.match",!1)}}]);
